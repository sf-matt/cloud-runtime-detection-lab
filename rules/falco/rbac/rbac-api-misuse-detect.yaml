- rule: RBAC API Misuse Detected
  desc: Detects Kubernetes API requests that return a Forbidden error when accessing sensitive resources.
  condition: >
    jevt.value.error = "Forbidden" and
    jevt.value.kind = "secrets" and
    jevt.value.verb in (get, list)
  output: >
    RBAC API misuse detected: user=%jevt.value.user.username verb=%jevt.value.verb resource=%jevt.value.kind
    uri=%jevt.value.requestURI reason=%jevt.value.responseStatus.message
  priority: WARNING
  tags: [k8s, rbac, audit, detection]
  source: k8s_audit